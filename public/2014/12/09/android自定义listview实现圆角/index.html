<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  
  <title>android自定义listview实现圆角 | 挖之家</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
    <meta name="author" content="Xin Zhang">
  
  
    <meta name="description" content="在项目中我们会经常遇到这种圆角效果，因为直角的看起来确实不那么雅观，可能大家会想到用图片实现，试想上中下要分别做三张图片，这样既会是自己的项目增大也会增加内存使用量，所以使用shape来实现不失为一种更好的实现方式。在这里先看一下shape的使用：">
  
  <meta content="article" property="og:type">
<meta content="android自定义listview实现圆角" property="og:title">
<meta content="http://waakaakaa.github.io/2014/12/09/android自定义listview实现圆角/" property="og:url">
<meta content="/img/android自定义listview实现圆角/1.jpg" property="og:image">
<meta content="挖之家" property="og:site_name">
<meta content="在项目中我们会经常遇到这种圆角效果，因为直角的看起来确实不那么雅观，可能大家会想到用图片实现，试想上中下要分别做三张图片，这样既会是自己的项目增大也会增加内存使用量，所以使用shape来实现不失为一种更好的实现方式。在这里先看一下shape的使用：" property="og:description">
<meta content="summary" name="twitter:card">
  
  
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <div class="wrapper">
    <header id="header">
  <div class="title">
    <h1><a href="/">挖之家</a></h1>
    <p><a href="/">太阳每天都是欣的</a></p>
  </div>
  <nav class="nav">
    <ul>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/about">About</a></li>
      
      
    </ul>
    <div class="clearfix"></div>
  </nav>
  <div class="clearfix"></div>
</header>
    <div class="content"><article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2014/12/09/android自定义listview实现圆角/">
  <time datetime="2014-12-08T16:53:48.000Z">
    12月 9 2014
  </time>
</a>
    
    
  
    <h1 class="title">android自定义listview实现圆角</h1>
  

  </header>
  
  <div class="entry">
    
      <p>在项目中我们会经常遇到这种圆角效果，因为直角的看起来确实不那么雅观，可能大家会想到用图片实现，试想上中下要分别做三张图片，这样既会是自己的项目增大也会增加内存使用量，所以使用shape来实现不失为一种更好的实现方式。在这里先看一下shape的使用：</p>
<a id="more"></a>

<pre><code><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="tag">&lt;<span class="title">shape</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span> 
       <span class="attribute">android:shape</span>=<span class="value">"rectangle"</span>
       &gt;</span>

      <span class="comment">&lt;!-- 渐变 --&gt;</span> 
       <span class="tag">&lt;<span class="title">gradient</span>  
       <span class="attribute">android:startColor</span>=<span class="value">"#B5E7B8"</span>  
       <span class="attribute">android:endColor</span>=<span class="value">"#76D37B"</span>  
       <span class="attribute">android:angle</span>=<span class="value">"270"</span> 
       /&gt;</span>

      <span class="comment">&lt;!-- 描边 --&gt;</span> 
      <span class="comment">&lt;!--  &lt;stroke android:width="1dip"     
       android:color="@color/blue" 
       /&gt;  --&gt;</span>

      <span class="comment">&lt;!-- 实心 --&gt;</span>
      <span class="comment">&lt;!--  &lt;solid android:color="#FFeaeaea"
       /&gt;  --&gt;</span>

      <span class="comment">&lt;!-- 圆角 --&gt;</span>  
       <span class="tag">&lt;<span class="title">corners</span> 
       <span class="attribute">android:bottomRightRadius</span>=<span class="value">"4dip"</span> 
       <span class="attribute">android:bottomLeftRadius</span>=<span class="value">"4dip"</span> 
       <span class="attribute">android:topLeftRadius</span>=<span class="value">"4dip"</span> 
       <span class="attribute">android:topRightRadius</span>=<span class="value">"4dip"</span> 
       /&gt;</span>
<span class="tag">&lt;/<span class="title">shape</span>&gt;</span> 
</code></pre><p>solid：实心，就是填充的意思<br>android:color指定填充的颜色</p>
<p>gradient：渐变<br>android:startColor和android:endColor分别为起始和结束颜色，ndroid:angle是渐变角度，必须为45的整数倍。<br>另外渐变默认的模式为android:type=”linear”，即线性渐变，可以指定渐变为径向渐变，android:type=”radial”，径向渐变需要指定半径android:gradientRadius=”50”。</p>
<p>stroke：描边<br>android:width=”2dp” 描边的宽度，android:color 描边的颜色。</p>
<p>我们还可以把描边弄成虚线的形式，设置方式为：<br>android:dashWidth=”5dp”<br>android:dashGap=”3dp”<br>其中android:dashWidth表示’-‘这样一个横线的宽度，android:dashGap表示之间隔开的距离。</p>
<p>corners：圆角<br>android:radius为角的弧度，值越大角越圆。</p>
<p>OK，下面开始自定义listview实现圆角的例子：</p>
<p>首先在drawable下定义只有一项的选择器app_list_corner_round.xml：</p>
<pre><code><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="tag">&lt;<span class="title">shape</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span> 
       <span class="attribute">android:shape</span>=<span class="value">"rectangle"</span>
       &gt;</span>

      <span class="comment">&lt;!-- 渐变 --&gt;</span> 
       <span class="tag">&lt;<span class="title">gradient</span>  
       <span class="attribute">android:startColor</span>=<span class="value">"#B5E7B8"</span>  
       <span class="attribute">android:endColor</span>=<span class="value">"#76D37B"</span>  
       <span class="attribute">android:angle</span>=<span class="value">"270"</span> 
       /&gt;</span>

      <span class="comment">&lt;!-- 描边 --&gt;</span> 
      <span class="comment">&lt;!--  &lt;stroke android:width="1dip"     
       android:color="@color/blue" 
       /&gt;  --&gt;</span>

      <span class="comment">&lt;!-- 实心 --&gt;</span>
      <span class="comment">&lt;!--  &lt;solid android:color="#FFeaeaea"
       /&gt;  --&gt;</span>

      <span class="comment">&lt;!-- 圆角 --&gt;</span>  
       <span class="tag">&lt;<span class="title">corners</span> 
       <span class="attribute">android:bottomRightRadius</span>=<span class="value">"4dip"</span> 
       <span class="attribute">android:bottomLeftRadius</span>=<span class="value">"4dip"</span> 
       <span class="attribute">android:topLeftRadius</span>=<span class="value">"4dip"</span> 
       <span class="attribute">android:topRightRadius</span>=<span class="value">"4dip"</span> 
       /&gt;</span>
<span class="tag">&lt;/<span class="title">shape</span>&gt;</span> 
</code></pre><p>如果是顶部第一项，则上面两个角为圆角，app_list_corner_round_top.xml：</p>
<pre><code><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="tag">&lt;<span class="title">shape</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span> 
       <span class="attribute">android:shape</span>=<span class="value">"rectangle"</span>
       &gt;</span>


       <span class="tag">&lt;<span class="title">gradient</span>  
       <span class="attribute">android:startColor</span>=<span class="value">"#B5E7B8"</span>  
       <span class="attribute">android:endColor</span>=<span class="value">"#76D37B"</span>  
       <span class="attribute">android:angle</span>=<span class="value">"270"</span> 
       /&gt;</span>

      <span class="comment">&lt;!--  &lt;stroke android:width="1dip" 
       android:color="@color/blue" 
       /&gt;  --&gt;</span>
      <span class="comment">&lt;!--  &lt;solid android:color="#FFeaeaea"
       /&gt;  --&gt;</span>
       <span class="tag">&lt;<span class="title">corners</span> 
           <span class="attribute">android:topLeftRadius</span>=<span class="value">"4dip"</span> 
           <span class="attribute">android:topRightRadius</span>=<span class="value">"4dip"</span> 

       /&gt;</span>
<span class="tag">&lt;/<span class="title">shape</span>&gt;</span> 
</code></pre><p>如果是底部最后一项，则下面两个角为圆角，app_list_corner_round_bottom.xml：</p>
<pre><code><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="tag">&lt;<span class="title">shape</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span> 
       <span class="attribute">android:shape</span>=<span class="value">"rectangle"</span>
       &gt;</span>


       <span class="tag">&lt;<span class="title">gradient</span>  
       <span class="attribute">android:startColor</span>=<span class="value">"#B5E7B8"</span>  
       <span class="attribute">android:endColor</span>=<span class="value">"#76D37B"</span>  
       <span class="attribute">android:angle</span>=<span class="value">"270"</span> 
       /&gt;</span>

      <span class="comment">&lt;!--  &lt;stroke android:width="1dip" 
       android:color="@color/blue" 
       /&gt;  --&gt;</span>
      <span class="comment">&lt;!--  &lt;solid android:color="#FFeaeaea"
       /&gt;  --&gt;</span>
       <span class="tag">&lt;<span class="title">corners</span> 
       <span class="attribute">android:bottomRightRadius</span>=<span class="value">"4dip"</span> 
       <span class="attribute">android:bottomLeftRadius</span>=<span class="value">"4dip"</span> 

       /&gt;</span>
<span class="tag">&lt;/<span class="title">shape</span>&gt;</span> 
</code></pre><p>如果是中间项，则应该不需要圆角， app_list_corner_round_center.xml:</p>
<pre><code><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="tag">&lt;<span class="title">shape</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span> 
       <span class="attribute">android:shape</span>=<span class="value">"rectangle"</span>
       &gt;</span>


       <span class="tag">&lt;<span class="title">gradient</span>  
       <span class="attribute">android:startColor</span>=<span class="value">"#B5E7B8"</span>  
       <span class="attribute">android:endColor</span>=<span class="value">"#76D37B"</span>  
       <span class="attribute">android:angle</span>=<span class="value">"270"</span> 
       /&gt;</span>

      <span class="comment">&lt;!--  &lt;stroke android:width="1dip" 
       android:color="@color/blue" 
       /&gt;  --&gt;</span>
      <span class="comment">&lt;!--  &lt;solid android:color="#FFeaeaea"
       /&gt;  --&gt;</span>
      <span class="comment">&lt;!--  &lt;corners 
       android:bottomRightRadius="4dip" 
       android:bottomLeftRadius="4dip" 

       /&gt; --&gt;</span>
<span class="tag">&lt;/<span class="title">shape</span>&gt;</span> 
</code></pre><p>listview的背景图片大家可以使用stroke描述，这里我使用了一张9PNG的图片，因为9PNG图片拉伸不失真。<br>定义好了圆角的shape接下来是自定义listview的实现：</p>
<pre><code><span class="keyword">package</span> cn.com.karl.view;

<span class="keyword">import</span> cn.com.karl.test.R;
<span class="keyword">import</span> android.content.Context;
<span class="keyword">import</span> android.util.AttributeSet;
<span class="keyword">import</span> android.view.MotionEvent;
<span class="keyword">import</span> android.widget.AdapterView;
<span class="keyword">import</span> android.widget.ListView;

<span class="javadoc">/**
 * 圆角ListView
 */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CornerListView</span> <span class="keyword">extends</span> <span class="title">ListView</span> {</span>
    <span class="keyword">public</span> <span class="title">CornerListView</span>(Context context) {
        <span class="keyword">super</span>(context);
    }

    <span class="keyword">public</span> <span class="title">CornerListView</span>(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyle) {
        <span class="keyword">super</span>(context, attrs, defStyle);
    }

    <span class="keyword">public</span> <span class="title">CornerListView</span>(Context context, AttributeSet attrs) {
        <span class="keyword">super</span>(context, attrs);
    }

    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onInterceptTouchEvent</span>(MotionEvent ev) {
        <span class="keyword">switch</span> (ev.getAction()) {
        <span class="keyword">case</span> MotionEvent.ACTION_DOWN:
            <span class="keyword">int</span> x = (<span class="keyword">int</span>) ev.getX();
            <span class="keyword">int</span> y = (<span class="keyword">int</span>) ev.getY();
            <span class="keyword">int</span> itemnum = pointToPosition(x, y);
            <span class="keyword">if</span> (itemnum == AdapterView.INVALID_POSITION)
                <span class="keyword">break</span>;
            <span class="keyword">else</span> {
                <span class="keyword">if</span> (itemnum == <span class="number">0</span>) {
                    <span class="keyword">if</span> (itemnum == (getAdapter().getCount() - <span class="number">1</span>)) {
                        <span class="comment">//只有一项</span>
                        setSelector(R.drawable.app_list_corner_round);
                    } <span class="keyword">else</span> {
                        <span class="comment">//第一项</span>
                        setSelector(R.drawable.app_list_corner_round_top);
                    }
                } <span class="keyword">else</span> <span class="keyword">if</span> (itemnum == (getAdapter().getCount() - <span class="number">1</span>))
                    <span class="comment">//最后一项</span>
                    setSelector(R.drawable.app_list_corner_round_bottom);
                <span class="keyword">else</span> {
                    <span class="comment">//中间项</span>
                    setSelector(R.drawable.app_list_corner_round_center);
                }
            }
            <span class="keyword">break</span>;
        <span class="keyword">case</span> MotionEvent.ACTION_UP:
            <span class="keyword">break</span>;
        }
        <span class="keyword">return</span> <span class="keyword">super</span>.onInterceptTouchEvent(ev);
    }
}
</code></pre><p>下面看一下列表布局文件setting。xml：</p>
<pre><code><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span>
    <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span>
    <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span>
    <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span> &gt;</span>

    <span class="tag">&lt;<span class="title">include</span> <span class="attribute">layout</span>=<span class="value">"@layout/head"</span> /&gt;</span>

    <span class="tag">&lt;<span class="title">cn.com.karl.view.CornerListView
</span>        <span class="attribute">android:id</span>=<span class="value">"@+id/setting_list"</span>
        <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span>
        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>
        <span class="attribute">android:layout_margin</span>=<span class="value">"10dip"</span>
        <span class="attribute">android:background</span>=<span class="value">"@drawable/corner_list_bg"</span>
        <span class="attribute">android:cacheColorHint</span>=<span class="value">"#00000000"</span> /&gt;</span>

<span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span>
</code></pre><p>自定义Listview对应的item文件 main_tab_setting_list_item.xml</p>
<pre><code><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>  
    <span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span>  
        <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span>  
        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>&gt;</span>  

        <span class="tag">&lt;<span class="title">RelativeLayout</span>  
            <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span>  
            <span class="attribute">android:layout_height</span>=<span class="value">"50dp"</span>   
            <span class="attribute">android:gravity</span>=<span class="value">"center_horizontal"</span>&gt;</span>  

            <span class="tag">&lt;<span class="title">TextView</span>  
                <span class="attribute">android:id</span>=<span class="value">"@+id/tv_system_title"</span>  
                <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span>  
                <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>  
                <span class="attribute">android:layout_alignParentLeft</span>=<span class="value">"true"</span>  
                <span class="attribute">android:layout_centerVertical</span>=<span class="value">"true"</span>  
                <span class="attribute">android:layout_marginLeft</span>=<span class="value">"10dp"</span>  
                <span class="attribute">android:text</span>=<span class="value">"分享"</span>   
                <span class="attribute">android:textColor</span>=<span class="value">"@color/black"</span>/&gt;</span>  

            <span class="tag">&lt;<span class="title">ImageView</span>  
                <span class="attribute">android:id</span>=<span class="value">"@+id/iv_system_right"</span>  
                <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span>  
                <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span>  
                <span class="attribute">android:layout_alignParentRight</span>=<span class="value">"true"</span>  
                <span class="attribute">android:layout_centerVertical</span>=<span class="value">"true"</span>  
                <span class="attribute">android:layout_marginRight</span>=<span class="value">"10dp"</span>  
                <span class="attribute">android:src</span>=<span class="value">"@drawable/arrow1"</span> /&gt;</span>  
        <span class="tag">&lt;/<span class="title">RelativeLayout</span>&gt;</span>  

    <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span>  
</code></pre><p>最后是在activity中填充适配器：</p>
<pre><code><span class="keyword">package</span> cn.com.karl.test;

<span class="keyword">import</span> java.util.ArrayList;
<span class="keyword">import</span> java.util.HashMap;
<span class="keyword">import</span> java.util.List;
<span class="keyword">import</span> java.util.Map;

<span class="keyword">import</span> cn.com.karl.view.CornerListView;
<span class="keyword">import</span> android.os.Bundle;
<span class="keyword">import</span> android.view.View;
<span class="keyword">import</span> android.widget.SimpleAdapter;

<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SettingActivity</span> <span class="keyword">extends</span> <span class="title">BaseActivity</span> {</span>

    <span class="keyword">private</span> CornerListView cornerListView = <span class="keyword">null</span>;

    <span class="keyword">private</span> List&lt;Map&lt;String, String&gt;&gt; listData = <span class="keyword">null</span>;
    <span class="keyword">private</span> SimpleAdapter adapter = <span class="keyword">null</span>;

    <span class="annotation">@Override</span>
    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span>(Bundle savedInstanceState) {
        <span class="comment">// TODO Auto-generated method stub</span>
        <span class="keyword">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.setting);

        cornerListView = (CornerListView)findViewById(R.id.setting_list);
        setListData();

        adapter = <span class="keyword">new</span> SimpleAdapter(getApplicationContext(), listData, R.layout.main_tab_setting_list_item ,
                <span class="keyword">new</span> String[]{<span class="string">"text"</span>}, <span class="keyword">new</span> <span class="keyword">int</span>[]{R.id.tv_system_title});
                        cornerListView.setAdapter(adapter);

        initHead();
        btn_leftTop.setVisibility(View.INVISIBLE);
        tv_head.setText(<span class="string">"设置"</span>);
    }


    <span class="javadoc">/**
     * 设置列表数据
     */</span>
    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setListData</span>(){
        listData = <span class="keyword">new</span> ArrayList&lt;Map&lt;String,String&gt;&gt;();

        Map&lt;String,String&gt; map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();
        map.put(<span class="string">"text"</span>, <span class="string">"分享"</span>);
        listData.add(map);

        map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();
        map.put(<span class="string">"text"</span>, <span class="string">"检查新版本"</span>);
        listData.add(map);

        map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();
        map.put(<span class="string">"text"</span>, <span class="string">"反馈意见"</span>);
        listData.add(map);

        map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();
        map.put(<span class="string">"text"</span>, <span class="string">"关于我们"</span>);
        listData.add(map);

        map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();
        map.put(<span class="string">"text"</span>, <span class="string">"支持我们，请点击这里的广告"</span>);
        listData.add(map);
    }

}
</code></pre><p>这样就完成了，虽然过程较繁杂，但是当做一个好的模板以后使用会方便很多，最后看一下实现效果和我们用图片实现的一样吗</p>
<p><img src="/img/android自定义listview实现圆角/1.jpg" alt="image"></p>
<p><img src="/img/android自定义listview实现圆角/2.jpg" alt="image"></p>

    
  </div>
  <footer>
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>

</div>
  </div>
  <footer id="footer"><div class="copyright">
  
  &copy; 2015 <a href="/">Xin Zhang</a>
  
</div>
<div class="theme-copyright">
  Theme by <a href="https://github.com/orderedlist" target="_blank">orderedlist</a>
   | 
  Redesign by <a href="http://heroicyang.com/" target="_blank">Heroic Yang</a>
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="/js/scale.fix.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    $('.fancybox').fancybox();
  })(jQuery);
</script>


</body>
</html>